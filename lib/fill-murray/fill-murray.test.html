<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <script src="../../node_modules/@webcomponents/webcomponentsjs/webcomponents-hi-sd-ce.js"></script>
    <script src="../../node_modules/web-component-tester/browser.js"></script>
    <script src="./fill-murray.js"></script>
</head>
<body>
    <test-fixture id="fill-murray-fixture">
        <fill-murray width="30" height="20" gray></fill-murray>
        <fill-murray width="20" height="30"></fill-murray>
        <fill-murray width="20" height="30" gray></fill-murray>
        <fill-murray width="30" height="20"></fill-murray>
    </test-fixture>
    <script>
        describe('<fill-murray>', function() {
            const components = document.querySelectorAll('fill-murray');

            it('should render an img element in the shadowRoot', () => {
                components.forEach(c => {
                    assert.isOk(c.shadowRoot.querySelector('img'));
                });
            });

            it('should use width, height and gray attributes when creating urls', () => {
                components.forEach(c => {
                    const src = c.shadowRoot.querySelector('img').src;
                    const width = c.getAttribute('width');
                    const height = c.getAttribute('height');
                    const gray = c.hasAttribute('gray');
                    const widthAndHeight = `\/${width}\/${height}$`;
                    const re = new RegExp(`.*${gray ? '/g' : ''}${widthAndHeight}`);

                    console.log(re, src, re.test(src));

                    assert.isOk(re.test(src));
                });
            });
        });
    </script>
</body>
</html>
